global
    log 127.0.0.1 local0  # Use local syslog for logging
    # log stdout format raw local0
    maxconn 4096          # Maximum number of connections
    stats socket /var/run/haproxy.sock mode 600 level admin  # Admin socket for control

defaults
    log     global
    option  httplog              # Enable HTTP logging
    mode    http                 # Set mode to HTTP
    timeout connect 5000ms       # Timeout for connection attempts
    timeout client  50000ms      # Timeout for client responses
    timeout server  50000ms      # Timeout for server responses
    retries 3                    # Retry 3 times on failure

frontend http-in
    bind *:80                    # Listen on port 80
    default_backend servers       # Forward to the backend servers
    capture request header Host len 50

backend servers
    balance roundrobin            # Distribute requests evenly
    server server1 localhost:8082 check  # Forward traffic to localhost:8082
    server server2 localhost:8083 check  # Forward traffic to localhost:8083

# Stats page configuration
listen stats
    bind *:8877                  # Stats page accessible at port 8080
    mode http
    stats enable
    stats hide-version
    stats realm HAProxy\ Statistics
    stats uri /stats      # Access stats at /haproxy?stats
    stats auth admin:password     # Basic auth: admin/password
